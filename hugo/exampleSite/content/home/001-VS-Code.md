+++
title = "Opensource Contribution with VS Code embeded Git Utility"
outputs = ["Reveal"]
[logo]
src = "github-logo.png"
[reveal_hugo]
custom_theme = "reveal-hugo/themes/robot-lung.css"
margin = 0.2
weight = 10
+++

## VS Code ë¥¼ í™œìš©í•œ Git

- ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ìœˆë„ìš°, macOS, ë¦¬ëˆ…ìŠ¤ìš©ìœ¼ë¡œ electron(node.js) ê¸°ë°˜ í¸ì§‘ê¸°ì…ë‹ˆë‹¤.
- Plugin ì„ ì¶”ê°€í•˜ì—¬ í’ë¶€í•œ ê¸°ëŠ¥ì„ ê°€ì§„ IDE ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- VS Code ìì²´ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” Git ê¸°ëŠ¥ì´ ì°¸ í¸ë¦¬í•©ë‹ˆë‹¤.
  - ì² ê¶Œì²˜ëŸ¼ ì»¤ë§¨ë“œë¥¼ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê¸°ëŠ¥ì„ ë²„íŠ¼ í•˜ë‚˜ë¡œ í•¨ì¶•í–ˆìŠµë‹ˆë‹¤.
- ì¶”ê°€ì ìœ¼ë¡œ Git ê¸°ëŠ¥ ì™¸ì—ë„ SSH ë˜ëŠ” Live Share ì›ê²© ê°œë°œ í™˜ê²½ ë° ë©€í‹° ìœ ì € í¸ì§‘ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

## Git Command

<img src="0010-git-cheetsheet.png" alt="ê·¸ë¦¼ 2 : Git ì»¤ë§¨ë“œ ìš”ì•½ë³¸" width=300>

---

## VS Code ë¥¼ í™œìš©í•œ Git

<img src="0010-vscode-git.png" alt="ê·¸ë¦¼ 1 : VS Code ì—ì„œ Git" width=300>

---

## Git History

- History ê·¸ë˜í”„ë¥¼ ë³¼ ë•Œ ìœ ìš©í•œ Git History í”ŒëŸ¬ê·¸ì¸
- ì»¤ë°‹ íˆìŠ¤í† ë¦¬ë¥¼ ë³´ê¸° ìœ„í•œ `git log`, íŠ¹ì • ì»¤ë°‹ì˜ ì‹œì ìœ¼ë¡œ ë°”ê¾¸ëŠ” `git checkout` ì— ëŒ€ì‘í•˜ëŠ” ê¸°ëŠ¥ì¸ë° ì§ê´€ì ìœ¼ë¡œ ë³´ê¸° í¸í•©ë‹ˆë‹¤.

<br>

<a href="http://www.youtube.com/watch?feature=player_embedded&v=hW6mhIaZjgw
" target="_blank"><img src="http://img.youtube.com/vi/hW6mhIaZjgw/0.jpg" 
alt="Git History" width="400" height="300" /></a>

---

## Git Lens

- ì½”ë“œ ë¼ì¸ & íŒŒì¼ ë³„ íˆìŠ¤í† ë¦¬ ì¶”ì ì— ìš©ì´í•œ Git Lens í”ŒëŸ¬ê·¸ì¸

<br>

<a href="http://www.youtube.com/watch?feature=player_embedded&v=WzIpMlS89HI
" target="_blank"><img src="http://img.youtube.com/vi/WzIpMlS89HI/0.jpg" 
alt="Git Lens" width="400" height="300" /></a>

---

## CONTRIBUTING
- ì˜¤í”ˆì†ŒìŠ¤ í”„ë¡œì íŠ¸
  - *Github*, Gitlab, cgit ë“±ì˜ git ê¸°ë°˜ í˜¸ìŠ¤íŒ…ì— ë ˆí¬ì§€í† ë¦¬ë“¤
- ê° í”„ë¡œì íŠ¸ì— Core, Util, Docs, unit-test, run-test, CI/CD ë“±ì— ê¸°ì—¬í•©ë‹ˆë‹¤.
  - 1. ê²Œì‹œíŒ í˜•íƒœì˜ í”Œë«í¼ì€ issue ë¥¼ í™•ì¸
  - 2. ë©”ì¼ë§ ê¸°ë°˜ì€ ë©”ì¼ë§ ë“±ë¡
- ê° í”„ë¡œì íŠ¸ë§ˆë‹¤ wiki ë‚˜ ìµœìƒë‹¨ì— ì»¨íŠ¸ë¦¬ë·°ì…˜ ê°€ì´ë“œ ë¬¸ì„œê°€ ìˆìŠµë‹ˆë‹¤.
  - [pytorch - CONTRIBUTING.md](https://github.com/pytorch/pytorch/blob/master/CONTRIBUTING.md)
  - [ebpf-for-windows - CONTRIBUTING.md](https://github.com/microsoft/ebpf-for-windows/blob/main/CONTRIBUTING.md)
  - [Linux Kernel - Patch submission notes](https://www.kernel.org/doc/html/latest/process/maintainer-tip.html?highlight=x86#patch-submission-notes)

---

## Contribution - Review

êµ­ì œì ìœ¼ë¡œ ë©”ì¼ë§ ê¸°ë¡ì´ ë‚¨ê¸° ë•Œë¬¸ì—,
ë©”ì¸í…Œì´ë„ˆë“¤ì´ ì‚¬ì†Œí•œ íŒ¨ì¹˜ë¼ë„ ì‹ ì¤‘í•˜ê²Œ ë¦¬ë·°í•´ì¤ë‹ˆë‹¤.
íŠ¹íˆ, ì»´íŒŒì¼ëœ ì½”ë“œ ê´€ë ¨í•´ì„œëŠ” íŒ¨ì¹˜ë¥¼ ë³´ë‚¸ ê¸°ì—¬ìë¥¼ ì„¤ë“í•˜ê¸° ìœ„í•´ì„œ
ì–´ë ¤ìš´ ë™ì‘ì„ ìì„¸íˆ ì„¤ëª…í•´ì£¼ì–´ ë§ì€ ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤.

---

## Github Uftrace - Commit

ì½”ë“œ ì •ì  ë¶„ì„ê¸°ë¡œ ë‚˜ì˜¨ í•­ëª© ì¤‘ì— Null ê´€ë ¨ ë³´ì•ˆ ì‚¬í•­ì´ ìˆì—ˆìŠµë‹ˆë‹¤.
```patch
cmds/graph.c:282: error: Null Dereference
  pointer `graph` last assigned on line 279 could be null 
  and is dereferenced at line 282, column 3.
  280.
  281.  if (tg->utg.graph && tg->utg.graph != graph) {
  282.          pr_dbg("detect new session: %.*s\n", SESSION_ID_LEN, graph->sess->sid);
         ^
  283.          tg->utg.new_sess = true;
  284.  }
```

ê¹ƒí—ˆë¸Œ ì´ìŠˆë¡œ ë“±ë¡í•œ ë’¤ì— í•´ë‹¹ ì‚¬í•­ì„ ë³´ì™„í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•©ë‹ˆë‹¤.

<a href="http://www.youtube.com/watch?feature=player_embedded&v=JDUcRbE1AsU
" target="_blank"><img src="http://img.youtube.com/vi/JDUcRbE1AsU/0.jpg" 
alt="Commit" width="300" height="240" /></a>

---

### Before PR

ì»¤ë°‹ì„ í•˜ê³  ë‚œ ë’¤ì— *ë§ˆì§€ë§‰ ì»¤ë°‹ ì‹¤í–‰ ì·¨ì†Œ*ë¡œ ì‰½ê²Œ ìŠ¤í…Œì´ì§• ë‹¨ê³„ë¡œ ë˜ëŒì•„ ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

<br>

ì½”ë“œë¦¬ë·°ë¥¼ ë°›ê³  ë³´ì™„í•  ë¶€ë¶„ì´ ìˆë‹¤ë©´, í™œìš©í•˜ë©´ ì¢‹ìŠµë‹ˆë‹¤.  

<a href="http://www.youtube.com/watch?feature=player_embedded&v=TIVsQCtw9ME
" target="_blank"><img src="http://img.youtube.com/vi/TIVsQCtw9ME/0.jpg" 
alt="Before PR" width="450" height="400" /></a>

---

### Before PR

ì»¤ë°‹í•˜ê³  í‘¸ì‰¬ë¡œ origin ë¸Œëœì¹˜ì— ë°˜ì˜ë˜ì—ˆëŠ”ë° ë˜ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤ë©´?  
ì»¤ë°‹ì„ ë‹¤ì‹œí•  í•„ìš” ì—†ì´ ë§ˆì§€ë§‰ ì»¤ë°‹ì„ `git push -f` ë¡œ ë®ì–´ ì¨ì¤ë‹ˆë‹¤.  

<img src="0022-commit-rollback-update-origin-branch.png" alt="commit-rollback-update-origin-branch.png">

---

## PR

fork í•œ ë¸Œëœì¹˜(Downstream)ë¥¼ origin(Upstream)ì— ë¨¸ì§€í•  ìˆ˜ ìˆë„ë¡ PR ì„ ì‘ì„±í•˜ëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.

<a href="http://www.youtube.com/watch?feature=player_embedded&v=wr6dkL0FGPA
" target="_blank"><img src="http://img.youtube.com/vi/wr6dkL0FGPA/0.jpg" 
alt="PR" width="600" height="480" /></a>

---

## Linux Kernel - Send Patch

ì†ŒìŠ¤ ìµœìƒë‹¨ì˜ `MAINTAINERS` ì°¸ê³ í•˜ì—¬ github ì™€ 1 ~ 2 ì™€ ìœ ì‚¬í•˜ì§€ë§Œ, PR ê³¼ ì½”ë“œ ë¦¬ë·°ë¥¼ ëª¨ë‘ ë‹´ë‹¹ìì˜ ë©”ì¼ë¡œ ë³´ëƒ…ë‹ˆë‹¤.

```bash
git send-email --smtp-pass="ë¹„ë°€ë²ˆí˜¸" \
  --to="ë©”ì¸í…Œì´ë„ˆ@ì´ë©”ì¼.ì£¼ì†Œ" \
  --cc="ì°¸ì¡°í• @ë©”ì¼.ì£¼ì†Œë“¤" \
  --confirm=always -M -1
```
ë’¤ì— ì¹´ìš´íŠ¸ëŠ” ì‘ì—…í•œ ì»¤ë°‹ ê°œìˆ˜ë¥¼ ë„£ìŠµë‹ˆë‹¤.
```bash
git send-email \
  --to="Thomas Gleixner <tglx@linutronix.de>, Marc Zyngier <maz@kernel.org>"
  --cc="linux-kernel@vger.kernel.org, Austin Kim <austindh.kim@gmail.com>"
  --confirm=always -M -1
```

### Send Patch(Cont'd)

ì»¤ë°‹ ë©”ì„¸ì§€ë¥¼ ì‘ì„±í•  ë•Œ, ì˜ì–´ ì‘ë¬¸ ì‹¤ë ¥ì´ í•„ìš”í•˜ì§€ë§Œ,  
ìš°ë¦¬ì—ê² *êµ¬ê¸€ ë²ˆì—­ê¸°*ê°€ ìˆìŠµë‹ˆë‹¤.

```patch
Hello

Since we have a macro defined in our IRQ subsystem internal functions to
traverse the list of actions, how about refactoring this loop?

- genirq: Use a common macro to go through the actions list
(f944b5a7aff05a244a6c8cac297819af09a199e4)

have a good day!

---
 kernel/irq/irqdesc.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/kernel/irq/irqdesc.c b/kernel/irq/irqdesc.c
index 939d21cd55c3..34a0cefff712 100644
--- a/kernel/irq/irqdesc.c
+++ b/kernel/irq/irqdesc.c
@@ -246,12 +246,12 @@ static ssize_t actions_show(struct kobject *kobj,
 			    struct kobj_attribute *attr, char *buf)
 {
 	struct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);
-	struct irqaction *action;
+	struct irqaction *action = NULL;
 	ssize_t ret = 0;
 	char *p = "";
 
 	raw_spin_lock_irq(&desc->lock);
-	for (action = desc->action; action != NULL; action = action->next) {
+	for_each_action_of_desc(desc, action) {
 		ret += scnprintf(buf + ret, PAGE_SIZE - ret, "%s%s",
 				 p, action->name);
 		p = ",";
-- 
```

---

### Maintainer's Code Review

ë³´ë‚¸ íŒ¨ì¹˜ì— ëŒ€í•´ì„œ ë³´ì™„í•´ì•¼í•  ì‚¬í•­ì„ í•´ë‹¹ ì„œë¸Œì‹œìŠ¤í…œì˜ ë©”ì¸í…Œì´ë„ˆê°€ ë§í•´ì¤ë‹ˆë‹¤.

```patch
Re: [PATCH] genirq: Refactor actions_show loop block using a common macro to go through the actions list
    - by Thomas Gleixner @ 2022-04-10 19:17 UTC [7%]

On Fri, Apr 08 2022 at 20:41, you wrote:

thanks for providing this patch.

> Hello.
>
> Since we have a macro defined in our IRQ subsystem internal functions to
> traverse the list of actions, how about refactoring this loop?
>
> - genirq: Use a common macro to go through the actions list
> (f944b5a7aff05a244a6c8cac297819af09a199e4)
>
> have a good day!

Neither 'Hello' nor 'have a good day' are part of the change log.

Also please write the changelog in a factual way and not in form of a
question. If you want to add a reference to a git commit, then please
use the canonical form as described in Documentation/process, where you
also find the general patch submission rules. There is also a tip tree
specific chapter:

https://www.kernel.org/doc/html/latest/process/maintainer-tip.html?highlight=x86#patch-submission-notes

Following these rules makes everyones life simpler.

> ---
>  kernel/irq/irqdesc.c | 4 ++--
>  1 file changed, 2 insertions(+), 2 deletions(-)
>
> diff --git a/kernel/irq/irqdesc.c b/kernel/irq/irqdesc.c
> index 939d21cd55c3..34a0cefff712 100644
> --- a/kernel/irq/irqdesc.c
> +++ b/kernel/irq/irqdesc.c
> @@ -246,12 +246,12 @@ static ssize_t actions_show(struct kobject *kobj,
>  			    struct kobj_attribute *attr, char *buf)
>  {
>  	struct irq_desc *desc = container_of(kobj, struct irq_desc, kobj);
> -	struct irqaction *action;
> +	struct irqaction *action = NULL;

There is no NULL initialization required.

Thanks,

        tglx
```

---

### Resend Patch V2

ë³´ì™„í•œ íŒ¨ì¹˜ë¥¼ ë‹¤ì‹œ ë³´ëƒ…ë‹ˆë‹¤. ì„œë¸Œì‹œìŠ¤í…œì˜ ë©”ì¸í…Œì´ë„ˆê°€ ë§í•´ì¤ë‹ˆë‹¤.

```patch
Refactor for loop to macro for_each_action_of_desc

---
 kernel/irq/irqdesc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/kernel/irq/irqdesc.c b/kernel/irq/irqdesc.c
index d323b180b0f3..5db0230aa6b5 100644
--- a/kernel/irq/irqdesc.c
+++ b/kernel/irq/irqdesc.c
@@ -251,7 +251,7 @@ static ssize_t actions_show(struct kobject *kobj,
 	char *p = "";
 
 	raw_spin_lock_irq(&desc->lock);
-	for (action = desc->action; action != NULL; action = action->next) {
+	for_each_action_of_desc(desc, action) {
 		ret += scnprintf(buf + ret, PAGE_SIZE - ret, "%s%s",
 				 p, action->name);
 		p = ",";
```

---

### Linux Kernel - Check Patch Merge

ë³´ë‚¸ íŒ¨ì¹˜ëŠ” v6.0-rc1 ì—ì„œ `[GIT pull] irq/core for v6.0-rc1 - by Thomas Gleixner @ 2022-08-01 14:48 UTC [1%]` ë¨¸ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.
```patch
The following commit has been merged into the irq/irqchip-next branch of irqchip:

Commit-ID:     c904cda04482d5ab545e5a82cee6084078ef9543
Gitweb:        https://git.kernel.org/pub/scm/linux/kernel/git/maz/arm-platforms/c904cda04482d5ab545e5a82cee6084078ef9543
AuthorDate:    Sun, 10 Jul 2022 20:26:14 +09:00
Committer:     Marc Zyngier <maz@kernel.org>
CommitterDate: Wed, 20 Jul 2022 15:21:32 +01:00

genirq: Use for_each_action_of_desc in actions_show()

Refactor action_show() to use for_each_action_of_desc instead
of a similar open-coded loop.

[maz: reword commit message]
Signed-off-by: Marc Zyngier <maz@kernel.org>
Link: https://lore.kernel.org/r/20220710112614.19410-1-p4ranlee@gmail.com
---
 kernel/irq/irqdesc.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/kernel/irq/irqdesc.c b/kernel/irq/irqdesc.c
index d323b18..5db0230 100644
--- a/kernel/irq/irqdesc.c
+++ b/kernel/irq/irqdesc.c
@@ -251,7 +251,7 @@ static ssize_t actions_show(struct kobject *kobj,
 	char *p = "";
 
 	raw_spin_lock_irq(&desc->lock);
-	for (action = desc->action; action != NULL; action = action->next) {
+	for_each_action_of_desc(desc, action) {
 		ret += scnprintf(buf + ret, PAGE_SIZE - ret, "%s%s",
 				 p, action->name);
 		p = ",";
```

---

# ğŸ¤—

ê³ ìƒí•˜ì…¨ìŠµë‹ˆë‹¤!

### Contribution - P.S.

ê¸°ì–µì— ë‚¨ëŠ” ëª‡ ê°€ì§€ íŒ¨ì¹˜ í•­ëª©ë“¤ì…ë‹ˆë‹¤.

1. `Xen Hypervisor` ì•”ë¬µì ì¸ casting ìœ¼ë¡œ ì‹¤ì œ ì½”ë“œê°€ ê¸¸ì–´ì§€ëŠ” í˜„ìƒ
```patch
From: Julien Grall <julien@xen.org>

Well... I don't think the one less operation is because of introduction 
of the local variable (see more below).

> 
> (1) before clean up
> 
> 0000000000001bb4 <p2m_set_entry>:
>      while ( nr )
>      1bb4:       b40005e2        cbz     x2, 1c70 <p2m_set_entry+0xbc>
> {
>      ...
>          if ( rc )
>      1c1c:       350002e0        cbnz    w0, 1c78 <p2m_set_entry+0xc4>
>          sgfn = gfn_add(sgfn, (1 << order));

1 << order is a 32-bit value but the second parameter is a 64-bit value 
(assuming arm64). So...

>      1c20:       1ad32373        lsl     w19, w27, w19   // <<< CES works
>      1c24:       93407e73        sxtw    x19, w19        // <<< well!

... this instruction is extending the 32-bit value to 64-bit value.

>      return _gfn(gfn_x(gfn) + i);
>      1c28:       8b1302d6        add     x22, x22, x19
>      return _mfn(mfn_x(mfn) + i);
>      1c2c:       8b130281        add     x1, x20, x19
>      1c30:       b100069f        cmn     x20, #0x1
>      1c34:       9a941034        csel    x20, x1, x20, ne  // ne = any
>      while ( nr )
>      1c38:       eb1302b5        subs    x21, x21, x19
>      1c3c:       540001e0        b.eq    1c78 <p2m_set_entry+0xc4>  // b.none
> 
> (2) Using again mask variable. mask = 1UL << order
> code show me   sxtw    x19, w19    operation disappeared.
This code is not only using a local variable but also using "1UL". So, I 
suspect that if you were using 1 << order, the instruction would re-appear.

Cheers,
Julien Grall
```

---

### Contribution - P.S.(Cont'd)

2. `Uftrace` í•¨ìˆ˜ë¥¼ ë›°ì–´ë‹¤ë‹ˆëŠ” ë¶„ê¸°(try-catch êµ¬í˜„) longjmp() ê°€ ì»´íŒŒì¼ëŸ¬ ìµœì í™”ë¡œ ë™ì‘ì„ ì•ˆí•˜ëŠ” í˜„ìƒ
```patch
diff --git a/tests/s-longjmp.c b/tests/s-longjmp.c
index 487e9264..64fc7c38 100644
--- a/tests/s-longjmp.c
+++ b/tests/s-longjmp.c
@@ -8,6 +8,9 @@ int foo(void)
        return 0;
 }

+#if __clang__
+__attribute__((optnone))
+#endif
 int bar(void)
 {
        return -1;

Another solution is to make bar function has more contents
so that it can't be optimized in clang.
```

---

# ğŸ¤—

ì§„ì§œ ë ğŸ¤—
